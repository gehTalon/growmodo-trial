<?php

/**
 * Carousel Copy Block Template.
 **/

$id = 'properties ' . $block['id'];
$className = 'properties';
?>
<section id="<?= $id ?>" class="<?= $className ?>">
  <div class="container">
    <div class="section-header d-flex justify-content-between align-items-center">
      <div class="section-text">
        <img src="<?= get_template_directory_uri(); ?>/assets/images/highlighted.png" alt="highlighted">
        <?php if ($heading = get_field('heading')) : ?>
          <h2><?= esc_html($heading); ?></h2>
        <?php endif; ?>

        <?php if ($details = get_field('sub_heading')) : ?>
          <p><?= esc_html($details); ?></p>
        <?php endif; ?>
      </div>

      <?php if ($link = get_field('link')) :
        $url    = $link['url'];
        $title  = $link['title'];
        $target = $link['target'] ?: '_self';
      ?>
        <div class="section-btn">
          <a href="<?= esc_url($url); ?>" class="cta-button transparent" target="<?= esc_attr($target); ?>">
            <?= esc_html($title); ?>
          </a>
        </div>
      <?php endif; ?>
    </div>
    <div class="section-content">
      <div class="carousel-copy-swiper">
        <?php if ($properties = get_field('select_property')) : ?>
          <div class="swiper-wrapper">
            <?php foreach ($properties as $item) :
              $property_id = $item['property'] ?? null;
              if (!$property_id) continue; // Skip if property ID is missing

              $link_url = get_permalink($property_id);
              $title    = get_the_title($property_id);
              $image    = get_the_post_thumbnail_url($property_id, 'medium');
              $top_title = $item['top_title'] ?? ''; // Avoid undefined index errors
              $property_details = get_field('description', $property_id);
              $price = get_field('price', $property_id);
              $amenities = get_field('amenities', $property_id);
              $number_of_bedrooms = $amenities['number_of_bedroom'];
              $number_of_bathroom = $amenities['number_of_bathroom'];
              $property_type = $amenities['property_type'];
            ?>
              <div class="swiper-slide">
                <?php if ($image) : ?>
                  <img src="<?= esc_url($image); ?>" alt="<?= esc_attr($title); ?>" />
                <?php endif; ?>

                <div class="content">
                  <?php if (!empty($top_title)) : ?>
                    <em><?= esc_html($top_title); ?></em>
                  <?php endif; ?>
                  <div class="property-holder">
                    <div class="property-info">
                      <h4 class="font-heading4"><?= esc_html($title); ?></h4>
                      <p><?= esc_html($property_details); ?>... <a href="<?= esc_url($link_url); ?>" class="read-more">Read More</a></p>
                    </div>
                    <div class="property-amenities">
                      <div class="property-amenity">
                        <span class="property-amenity-label">
                          <svg xmlns="http://www.w3.org/2000/svg" width="22" height="18" viewBox="0 0 22 18" fill="none">
                            <g clip-path="url(#clip0_122_2006)">
                              <path d="M11.0119 15.9597C8.01369 15.9597 5.01627 15.9597 2.01806 15.9597C1.71493 15.9597 1.57479 16.0984 1.57479 16.3977C1.57479 16.4752 1.57872 16.5527 1.574 16.6295C1.5677 16.7225 1.55825 16.8155 1.54093 16.9062C1.47637 17.2372 1.15907 17.5023 0.779568 17.4984C0.398493 17.4946 0.0827672 17.2116 0.025291 16.8481C0.0119061 16.7628 0.00482004 16.6752 0.00482004 16.5891C0.00403269 14.8279 -0.00777748 13.0659 0.00875676 11.3046C0.0182049 10.2783 0.397705 9.38527 1.12521 8.64186C1.56691 8.19069 2.09207 7.86976 2.69282 7.66511C3.16522 7.50465 3.65338 7.45581 4.15098 7.45581C8.76246 7.45736 13.3739 7.45348 17.9854 7.45891C19.3365 7.46046 20.4309 7.9969 21.2419 9.06356C21.6403 9.58837 21.8781 10.1845 21.9592 10.8357C21.9867 11.055 21.9985 11.2783 21.9993 11.5C22.0025 13.2101 22.0017 14.9202 22.0009 16.6302C22.0009 16.8977 21.934 17.1411 21.7104 17.3178C21.4741 17.5046 21.2104 17.5535 20.9293 17.4395C20.66 17.3295 20.49 17.1271 20.4514 16.838C20.4317 16.6922 20.4341 16.5426 20.4301 16.3953C20.4238 16.1574 20.3238 16.0139 20.1239 15.9698C20.0798 15.9597 20.0333 15.9605 19.9876 15.9605C16.9965 15.9605 14.0054 15.9605 11.0135 15.9605L11.0119 15.9597Z" fill="white" />
                              <path d="M10.9025 0.5C12.8472 0.5 14.7912 0.5 16.7351 0.5C17.3862 0.5 17.9949 0.643411 18.52 1.03953C19.1956 1.54884 19.59 2.21938 19.6231 3.06124C19.6514 3.77519 19.6388 4.4907 19.642 5.20543C19.6444 5.66589 19.642 6.12636 19.642 6.58682C19.642 6.62791 19.6396 6.67132 19.6286 6.71085C19.5948 6.83566 19.5263 6.88527 19.3971 6.86124C19.2562 6.83488 19.12 6.77829 18.979 6.76279C18.6476 6.72713 18.3153 6.70233 17.9823 6.68527C17.7602 6.67364 17.6917 6.63411 17.6602 6.41938C17.5595 5.73876 16.9194 5.12636 16.1005 5.13566C15.1872 5.14574 14.2739 5.13798 13.3613 5.13798C12.6819 5.13798 12.1016 5.53643 11.8709 6.16434C11.8378 6.25426 11.8252 6.35194 11.8079 6.44651C11.7756 6.61628 11.7119 6.67984 11.5402 6.68217C11.1804 6.68605 10.8198 6.68605 10.46 6.68217C10.2946 6.68062 10.2293 6.61628 10.1994 6.42791C10.1576 6.16357 10.0537 5.92791 9.88364 5.72093C9.57579 5.34574 9.17739 5.14186 8.68609 5.13953C7.74363 5.13488 6.80118 5.13721 5.85794 5.13876C5.06587 5.13953 4.44623 5.74884 4.34545 6.41783C4.31317 6.63411 4.24782 6.67209 4.02579 6.68605C3.6581 6.71008 3.29041 6.74419 2.92351 6.78295C2.81092 6.79457 2.70305 6.84264 2.59125 6.86124C2.47078 6.88062 2.41488 6.84031 2.38103 6.72403C2.36764 6.67829 2.36134 6.62946 2.36134 6.5814C2.36055 5.47674 2.3456 4.37209 2.36449 3.26744C2.38418 2.11163 2.92666 1.26202 3.988 0.748062C4.40844 0.545736 4.86431 0.5 5.3257 0.5C7.18462 0.5 9.04354 0.5 10.9025 0.5Z" fill="white" />
                            </g>
                            <defs>
                              <clipPath id="clip0_122_2006">
                                <rect width="22" height="17" fill="white" transform="translate(0 0.5)" />
                              </clipPath>
                            </defs>
                          </svg>
                        </span>
                        <span class="property-amenity-value"><?= esc_html($number_of_bedrooms); ?>-Bedroom</span>
                      </div>
                      <div class="property-amenity">
                        <span class="property-amenity-label">
                          <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22" fill="none">
                            <g clip-path="url(#clip0_122_2010)">
                              <path d="M1.26946 14.2616H11.11V16.0697H17.2615V14.2655H19.7054C19.8637 16.4158 19.8761 18.3304 17.6707 19.7897C17.6437 19.8075 17.6221 19.8318 17.5623 19.885C17.8335 20.1103 18.1009 20.3329 18.3655 20.5529C18.0082 20.8945 17.7212 21.169 17.3922 21.4842C17.1019 21.1848 16.7879 20.8373 16.4458 20.5207C16.3453 20.4275 16.1673 20.3894 16.0215 20.3802C15.7831 20.3657 15.5414 20.4045 15.301 20.4052C12.1057 20.4071 8.91048 20.4065 5.71457 20.4065C5.56154 20.4065 5.398 20.436 5.25679 20.3933C4.83054 20.2653 4.55994 20.4629 4.30642 20.7684C4.09034 21.0284 3.84405 21.2629 3.61877 21.5007C3.31468 21.1808 3.03949 20.8918 2.73474 20.5707C2.939 20.39 3.19843 20.1602 3.49004 19.9014C3.28906 19.7576 3.13866 19.6577 2.99614 19.5474C1.92821 18.7244 1.3509 17.6329 1.27537 16.2924C1.23793 15.6284 1.2688 14.9604 1.2688 14.2616H1.26946Z" fill="white" />
                              <path d="M1.27554 9.28709C1.27029 9.16821 1.26109 9.06116 1.26109 8.9541C1.26044 7.21363 1.25847 5.47381 1.26109 3.73333C1.26372 1.82078 2.59108 0.486191 4.50101 0.499984C5.14203 0.504581 5.80275 0.491446 6.41882 0.636595C7.5117 0.894711 8.20001 1.65264 8.53235 2.72057C8.59671 2.92811 8.68012 3.0286 8.90803 3.09034C10.194 3.43909 11.0964 4.641 11.1128 5.98216C11.1155 6.19824 11.1128 6.41432 11.1128 6.64879H5.02578C4.73548 5.11389 5.56959 3.52973 7.31335 3.03517C7.15573 2.35014 6.48121 1.77217 5.7732 1.74722C5.23792 1.72817 4.70067 1.7262 4.16539 1.74722C3.24261 1.78334 2.50044 2.63059 2.4965 3.64663C2.48994 5.39762 2.49453 7.14926 2.49453 8.90025C2.49453 9.01978 2.49453 9.13932 2.49453 9.28644H1.27423L1.27554 9.28709Z" fill="white" />
                              <path d="M11.0931 13.0327C10.9644 13.0327 10.8678 13.0327 10.7713 13.0327C7.64366 13.0327 4.5154 13.0334 1.38779 13.0321C0.714591 13.0321 0.230541 12.7135 0.0604342 12.1697C-0.195711 11.3514 0.384229 10.5632 1.26826 10.5514C2.20877 10.5389 3.14929 10.5481 4.0898 10.5481C6.29922 10.5481 8.50799 10.5481 10.7174 10.5481C10.8356 10.5481 10.9538 10.5481 11.0931 10.5481V13.0321V13.0327Z" fill="white" />
                              <path d="M16.0237 14.8711H12.3634C12.3575 14.7555 12.3477 14.6504 12.3477 14.5453C12.3464 13.2771 12.3464 12.0082 12.3477 10.7399C12.3483 9.82242 12.8494 9.31801 13.763 9.31407C14.1019 9.31275 14.4408 9.30553 14.7797 9.31604C15.5409 9.34034 16.0381 9.85197 16.0401 10.6152C16.044 11.9386 16.0414 13.2613 16.0401 14.5848C16.0401 14.6708 16.0309 14.7562 16.0237 14.8711Z" fill="white" />
                              <path d="M17.2832 13.0209V10.5482C17.8782 10.5482 18.4648 10.5462 19.0506 10.5488C19.356 10.5501 19.668 10.5252 19.9668 10.5744C20.619 10.6821 21.0433 11.2161 21.0164 11.8394C20.9901 12.4509 20.5389 12.9756 19.8985 13.0091C19.0394 13.0544 18.1764 13.0203 17.2839 13.0203L17.2832 13.0209Z" fill="white" />
                            </g>
                            <defs>
                              <clipPath id="clip0_122_2010">
                                <rect width="21.0171" height="21" fill="white" transform="translate(0 0.5)" />
                              </clipPath>
                            </defs>
                          </svg>
                        </span>
                        <span class="property-amenity-value"><?= esc_html($number_of_bathroom); ?>-Bathroom</span>
                      </div>
                      <div class="property-amenity">
                        <span class="property-amenity-label">
                          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="25" viewBox="0 0 24 25" fill="none">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M4.8001 20.3V4.70002H4.5001C4.00304 4.70002 3.6001 4.29708 3.6001 3.80002C3.6001 3.30297 4.00304 2.90002 4.5001 2.90002H19.5001C19.9972 2.90002 20.4001 3.30297 20.4001 3.80002C20.4001 4.29708 19.9972 4.70002 19.5001 4.70002H19.2001V20.3H19.5001C19.9972 20.3 20.4001 20.703 20.4001 21.2C20.4001 21.6971 19.9972 22.1 19.5001 22.1H15.3001C14.803 22.1 14.4001 21.6971 14.4001 21.2V18.2C14.4001 17.703 13.9972 17.3 13.5001 17.3H10.5001C10.003 17.3 9.6001 17.703 9.6001 18.2V21.2C9.6001 21.6971 9.19715 22.1 8.7001 22.1H4.5001C4.00304 22.1 3.6001 21.6971 3.6001 21.2C3.6001 20.703 4.00304 20.3 4.5001 20.3H4.8001ZM8.4001 7.10002C8.4001 6.76865 8.66873 6.50002 9.0001 6.50002H10.2001C10.5315 6.50002 10.8001 6.76865 10.8001 7.10002V8.30002C10.8001 8.6314 10.5315 8.90002 10.2001 8.90002H9.0001C8.66873 8.90002 8.4001 8.6314 8.4001 8.30002V7.10002ZM9.0001 11.3C8.66873 11.3 8.4001 11.5687 8.4001 11.9V13.1C8.4001 13.4314 8.66873 13.7 9.0001 13.7H10.2001C10.5315 13.7 10.8001 13.4314 10.8001 13.1V11.9C10.8001 11.5687 10.5315 11.3 10.2001 11.3H9.0001ZM13.2001 7.10002C13.2001 6.76865 13.4687 6.50002 13.8001 6.50002H15.0001C15.3315 6.50002 15.6001 6.76865 15.6001 7.10002V8.30002C15.6001 8.6314 15.3315 8.90002 15.0001 8.90002H13.8001C13.4687 8.90002 13.2001 8.6314 13.2001 8.30002V7.10002ZM13.8001 11.3C13.4687 11.3 13.2001 11.5687 13.2001 11.9V13.1C13.2001 13.4314 13.4687 13.7 13.8001 13.7H15.0001C15.3315 13.7 15.6001 13.4314 15.6001 13.1V11.9C15.6001 11.5687 15.3315 11.3 15.0001 11.3H13.8001Z" fill="white" />
                          </svg>
                        </span>
                        <span class="property-amenity-value"><?= esc_html($property_type); ?></span>
                      </div>
                    </div>
                    <div class="property-bottom-info">
                      <div class="property-price">
                        <span class="property-price-label">Price</span>
                        <span class="property-price-value">$<?= esc_html($price); ?></span>
                      </div>
                      <div class="property-link"><a href="<?= esc_url($link_url); ?>" class="cta-button">View Property Details</a></div>
                    </div>
                  </div>
                </div>
              </div>
            <?php endforeach; ?>
          </div>
        <?php endif; ?>
        <div class="properties-bottom-content d-flex justify-content-between">
          <div class="properties-pagination d-flex">
            <div class="properties-pagination-bullets"><span class="current-bullet">01</span> of 60</div>          
          </div>
          <div class="carousel-navigation d-flex">
            <div class="swiper-prev">
              <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" fill="none">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M25.5 15C25.5 15.6213 24.9963 16.125 24.375 16.125L8.41812 16.125L14.6547 22.0641C15.1026 22.4947 15.1166 23.2069 14.6859 23.6548C14.2553 24.1026 13.5431 24.1166 13.0953 23.6859L4.84525 15.8109C4.62466 15.5988 4.5 15.306 4.5 15C4.5 14.694 4.62466 14.4012 4.84525 14.1891L13.0953 6.31406C13.5431 5.88342 14.2553 5.89739 14.6859 6.34525C15.1166 6.79312 15.1026 7.5053 14.6547 7.93594L8.41812 13.875L24.375 13.875C24.9963 13.875 25.5 14.3787 25.5 15Z" fill="#808080" />
              </svg>
            </div>
            <div class="swiper-next">
              <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" fill="none">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M4.5 15C4.5 14.3787 5.00368 13.875 5.625 13.875L21.5819 13.875L15.3453 7.93593C14.8974 7.50529 14.8834 6.79312 15.3141 6.34525C15.7447 5.89738 16.4569 5.88342 16.9047 6.31406L25.1547 14.1891C25.3753 14.4012 25.5 14.694 25.5 15C25.5 15.306 25.3753 15.5988 25.1547 15.8109L16.9047 23.6859C16.4569 24.1166 15.7447 24.1026 15.3141 23.6547C14.8834 23.2069 14.8974 22.4947 15.3453 22.0641L21.5819 16.125L5.625 16.125C5.00368 16.125 4.5 15.6213 4.5 15Z" fill="white" />
              </svg>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>